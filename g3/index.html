<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Billionaire 5D: The Complete Empire</title>
    <style>
        :root { --gold: #d4af37; --neon: #00f3ff; --road: #222; }
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; touch-action: none; width: 100vw; height: 100vh; color: white; }
        canvas { display: block; position: absolute; inset: 0; }

        /* HUD & UI */
        #hud {
            position: absolute; top: 10px; left: 20px; right: 20px; 
            background: rgba(0,0,0,0.8); padding: 10px 20px; border-radius: 25px;
            display: flex; justify-content: space-between; z-index: 100; border: 1px solid var(--gold);
        }

        /* Controls */
        .controls { position: absolute; inset: 0; pointer-events: none; z-index: 150; }
        .zone { position: absolute; bottom: 20px; width: 35%; height: 180px; pointer-events: auto; display: flex; align-items: flex-end; }
        .left-zone { left: 20px; gap: 15px; }
        .right-zone { right: 20px; justify-content: flex-end; gap: 10px; }
        
        .btn { 
            width: 80px; height: 80px; border: 3px solid var(--gold); border-radius: 50%; 
            color: white; display: flex; align-items: center; justify-content: center; 
            background: rgba(0,0,0,0.5); font-weight: bold; backdrop-filter: blur(4px);
        }
        .gas-btn { width: 110px; height: 110px; border-color: lime; border-radius: 25px; }
        .mini-btn { width: 55px; height: 55px; font-size: 10px; border-color: orange; }

        /* Menus */
        #menu-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000;
        }
        .menu-card { background: #111; padding: 30px; border: 2px solid var(--gold); border-radius: 15px; text-align: center; }
        .opt { margin: 10px; padding: 10px 20px; border: 1px solid var(--gold); cursor: pointer; }
        .opt:hover { background: var(--gold); color: black; }
    </style>
</head>
<body>

<div id="menu-overlay">
    <div class="menu-card" id="start-card">
        <h1>üîê BOSS ACCESS</h1>
        <p>Biometric Scan Required</p>
        <button onclick="startGame()" style="padding:15px 30px; background:var(--gold); border:none; font-weight:bold; border-radius:5px;">START EMPIRE</button>
    </div>
    <div class="menu-card" id="garage-card" style="display:none;">
        <h1>üõ†Ô∏è GARAGE</h1>
        <div class="opt" onclick="setGear('AUTO')">AUTOMATIC</div>
        <div class="opt" onclick="setGear('MANUAL')">MANUAL (G1-G3)</div>
        <button onclick="closeGarage()" style="margin-top:10px;">EXIT GARAGE</button>
    </div>
</div>

<div id="hud">
    <div>üí∞ $<span id="cash">1,000,000,000</span></div>
    <div id="gear-ui" style="color:var(--neon)">AUTO</div>
    <div id="loc-ui" style="color:lime;">CITY</div>
</div>

<div class="controls">
    <div class="zone left-zone">
        <div id="btn-L" class="btn">‚óÄ</div>
        <div id="btn-R" class="btn">‚ñ∂</div>
    </div>
    <div class="zone right-zone">
        <div id="btn-S" class="btn mini-btn" style="display:none;">SHIFT</div>
        <div id="btn-E" class="btn mini-btn" style="border-color:red;">EXIT</div>
        <div id="btn-G" class="btn gas-btn">RACE</div>
    </div>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
let p = { x: 5000, y: 5000, a: 0, spd: 0, inCar: true, gearMode: 'AUTO', gear: 1, rain: false };
let carPos = { x: 5000, y: 5000, a: 0 };
let input = {};

function startGame() {
    document.getElementById('menu-overlay').style.display = 'none';
    if(document.documentElement.requestFullscreen) document.documentElement.requestFullscreen();
    resize();
}

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);

function setGear(m) {
    p.gearMode = m;
    p.gear = 1;
    document.getElementById('btn-S').style.display = m === 'MANUAL' ? 'flex' : 'none';
    closeGarage();
}
function closeGarage() { document.getElementById('menu-overlay').style.display = 'none'; }

function engine() {
    // Transmission Logic
    let maxS = p.gearMode === 'AUTO' ? 14 : (p.gear === 1 ? 5 : p.gear === 2 ? 10 : 20);
    let accel = p.inCar ? 0.35 : 0.15;

    if(input['btn-G'] && p.spd < maxS) p.spd += accel;
    if(input['btn-L']) p.a -= 0.06;
    if(input['btn-R']) p.a += 0.06;

    p.spd *= 0.97;
    p.x += Math.cos(p.a) * p.spd;
    p.y += Math.sin(p.a) * p.spd;

    // Exit System
    if(input['btn-E']) {
        if(p.inCar) { p.inCar = false; carPos = {x:p.x, y:p.y, a:p.a}; p.x += 60; }
        else if(Math.hypot(p.x-carPos.x, p.y-carPos.y) < 80) p.inCar = true, p.x=carPos.x, p.y=carPos.y, p.a=carPos.a;
        input['btn-E'] = false;
    }

    // Garage Zone (5200, 5000)
    if(Math.hypot(p.x-5200, p.y-5000) < 100 && p.spd < 0.5) {
        document.getElementById('menu-overlay').style.display = 'flex';
        document.getElementById('start-card').style.display = 'none';
        document.getElementById('garage-card').style.display = 'block';
    }

    document.getElementById('gear-ui').innerText = p.gearMode === 'MANUAL' ? 'G'+p.gear : 'AUTO';
}

function draw() {
    ctx.fillStyle = "#0a0a0a"; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.save(); ctx.translate(canvas.width/2 - p.x, canvas.height/2 - p.y);

    // City Area
    ctx.fillStyle = "#111"; ctx.fillRect(4500, 4500, 1000, 1000);
    // Village Farm
    ctx.fillStyle = "#3d2b1f"; ctx.fillRect(5500, 5500, 1000, 1000);
    ctx.fillStyle = "#228b22"; ctx.fillRect(5600, 5600, 400, 400); // Khet

    // Garage
    ctx.strokeStyle = "cyan"; ctx.strokeRect(5150, 4950, 100, 100);
    ctx.fillStyle = "cyan"; ctx.fillText("GARAGE", 5160, 4940);

    // Static Car
    if(!p.inCar) {
        ctx.save(); ctx.translate(carPos.x, carPos.y); ctx.rotate(carPos.a);
        ctx.fillStyle = "rgba(212,175,55,0.6)"; ctx.fillRect(-30,-18,60,36);
        ctx.restore();
    }

    // Player/Active Car
    ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.a);
    if(p.inCar) {
        ctx.shadowBlur = 15; ctx.shadowColor = "gold";
        ctx.fillStyle = "gold"; ctx.fillRect(-30,-18,60,36);
    }
    ctx.fillStyle = "#ffdbac"; ctx.beginPath(); ctx.arc(0,0,12,0,7); ctx.fill();
    ctx.restore();

    ctx.restore();
    engine();
    requestAnimationFrame(draw);
}

const bind = (id) => {
    let el = document.getElementById(id);
    el.ontouchstart = (e) => { 
        e.preventDefault(); 
        if(id === 'btn-S') { p.gear = p.gear >= 3 ? 1 : p.gear + 1; }
        else input[id] = true; 
    };
    el.ontouchend = () => { if(id !== 'btn-E' && id !== 'btn-S') input[id] = false; };
};
['btn-L', 'btn-R', 'btn-G', 'btn-E', 'btn-S'].forEach(bind);

resize();
draw();
</script>
</body>
</html>
